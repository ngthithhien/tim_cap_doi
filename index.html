<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
<title>T√¨m c·∫∑p ƒë√¥i ‚Äî L·ªõp L√°</title>

<style>
/* ===================== */
/*      FONT UTM AVO     */
/* ===================== */
/* ƒê·∫∑t file: ./fonts/utm-avo.ttf */
@font-face {
  font-family: "UTM Avo";
  src: url("./fonts/utm-avo.ttf") format("truetype");
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

/* ===================== */
/*        CSS CH√çNH      */
/* ===================== */

* { box-sizing: border-box; }
html,body{ height:100%; }
body{
  margin:0;
  background:linear-gradient(135deg,#667eea,#764ba2);
  font-family:"UTM Avo", sans-serif;
  height:100vh;
  width:100vw;
  display:flex;
  justify-content:center;
  align-items:center;
  overflow:hidden;
  color:black; /* TO√ÄN B·ªò CH·ªÆ M√ÄU ƒêEN */
  position:relative;
}

.container{
  width:100%;
  height:100%;
  display:flex;
  justify-content:center;
  align-items:center;
  position:relative;
  flex-direction:column;
}

/* Ti√™u ƒë·ªÅ */
h2{
  margin:0;
  font-size:clamp(36px,6vw,60px);
  text-align:center;
  text-shadow:none; /* b·ªè b√≥ng ƒë·ªÉ ch·ªØ ƒëen r√µ */
  font-family:"UTM Avo", sans-serif;
  color:black;
}

/* Grid */
.grid{
  display:grid;
  grid-template-columns:repeat(3,235.44px);
  grid-template-rows:repeat(2,235.44px);
  gap:20px;
  margin-top:40px;
}

/* Card */
.card{
  position:relative;
  width:100%;
  padding-top:100%;
  border-radius:20px;
  cursor:pointer;
  perspective:800px;
  transition:transform 0.3s;
}
.card:hover{
  transform:scale(1.05) rotateZ(-2deg);
}

.card-inner{
  position:absolute;
  inset:0;
  border-radius:20px;
  transition:transform .6s;
  transform-style:preserve-3d;
}
.card.flipped .card-inner{
  transform:rotateY(180deg);
}

/* SIDE: tƒÉng 20% so v·ªõi gi√° tr·ªã tr∆∞·ªõc (82px -> ~98px), b·∫±ng clamp */
.side{
  position:absolute;
  inset:0;
  backface-visibility:hidden;
  border-radius:20px;
  display:flex;
  align-items:center;
  justify-content:center;

  /* k√≠ch th∆∞·ªõc l·ªõn h∆°n ~20% */
  font-size:clamp(98px,14vw,135px);
  font-weight:normal; /* ch·ªØ th∆∞·ªùng */
  text-transform:none;
  color:black; /* ch·ªØ ƒëen */

  transition:0.3s;
  font-family:"UTM Avo", sans-serif;
}

/* n·ªÅn m·∫∑t tr∆∞·ªõc / sau gi·ªØ gradient nh∆∞ tr∆∞·ªõc, ch·ªØ v·∫´n ƒëen */
.front{
  background:linear-gradient(135deg,#4facfe,#00f2fe);
  box-shadow:0 6px 12px rgba(0,0,0,0.15);
}

.back{
  background:linear-gradient(135deg,#ff9a9e,#fad0c4);
  transform:rotateY(180deg);
  box-shadow:0 6px 12px rgba(0,0,0,0.15);
}

/* matched */
.card.matched .back{
  background:linear-gradient(135deg,#4ef59a,#00d0b0);
  color:black;
  box-shadow:0 0 30px #4ef59a80;
  animation:pulse 0.8s infinite alternate;
}
@keyframes pulse {
  0% { transform:scale(1); box-shadow:0 0 15px #4ef59a80; }
  50% { transform:scale(1.1); box-shadow:0 0 25px #4ef59aaa; }
  100% { transform:scale(1); box-shadow:0 0 15px #4ef59a80; }
}

/* n√∫t g√≥c tr√™n */
.top-buttons{
  position:absolute;
  right:10px;
  top:10px;
  display:flex;
  flex-direction:column;
  gap:12px;
  z-index:10;
}
.top-buttons button{
  padding:12px 16px;
  font-size:16px;
  font-weight:normal;
  border:none;
  border-radius:8px;
  cursor:pointer;
  background:#ffffffcc;
  color:#111;
  box-shadow:0 4px 12px rgba(0,0,0,0.12);
  transition:0.18s;
  font-family:"UTM Avo", sans-serif;
}
.top-buttons button:hover{ transform:scale(1.06); background:#fff; }

/* Timer & message: ch·ªØ ƒëen */
.timer{
  position:absolute;
  top:100px;
  left:50%;
  transform:translateX(-50%);
  font-size:clamp(36px,6vw,48px);
  font-weight:900;
  display:none;
  text-shadow:none;
  z-index:10;
  font-family:"UTM Avo", sans-serif;
  color:black;
}

.message{
  position:absolute;
  top:200px;
  font-size:clamp(36px,6vw,48px);
  font-weight:normal;
  display:none;
  z-index:20;
  text-align:center;
  color:black; /* ƒë·∫£m b·∫£o message m√†u ƒëen */
  font-family:"UTM Avo", sans-serif;
}

/* ph√°o hoa */
.firework{
  position:absolute;
  width:10px; height:10px;
  border-radius:50%;
  background:yellow;
  box-shadow:0 0 20px 5px yellow;
  animation:explode 0.8s ease-out forwards;
}
@keyframes explode{
  0%{transform:scale(0); opacity:1;}
  100%{transform:scale(5); opacity:0;}
}

/* responsive */
@media (max-width:900px){
  .grid{ grid-template-columns:repeat(3,calc((100vw - 48px)/3)); grid-template-rows:repeat(2, calc((100vw - 48px)/3)); gap:12px; margin-top:20px;}
  .side{ font-size:clamp(72px,18vw,110px); }
}
</style>
</head>

<body>

<!-- √ÇM THANH -->
<audio id="correctSound" src="sounds/correct.mp3" preload="auto"></audio>
<audio id="wrongSound" src="sounds/wrong.mp3" preload="auto"></audio>
<audio id="winSound" src="sounds/win.mp3" preload="auto"></audio>
<audio id="clapSound" src="sounds/clap.mp3" preload="auto"></audio>
<audio id="startSound" src="sounds/start.mp3" preload="auto"></audio>
<audio id="endSound" src="sounds/end.mp3" preload="auto"></audio>

<!-- Count 5s -->
<audio id="count1" src="sounds/count1.mp3" preload="auto"></audio>
<audio id="count2" src="sounds/count2.mp3" preload="auto"></audio>
<audio id="count3" src="sounds/count3.mp3" preload="auto"></audio>
<audio id="count4" src="sounds/count4.mp3" preload="auto"></audio>
<audio id="count5" src="sounds/count5.mp3" preload="auto"></audio>

<!-- Count 10s cu·ªëi -->
<audio id="count1_end" src="sounds/count1_end.mp3" preload="auto"></audio>
<audio id="count2_end" src="sounds/count2_end.mp3" preload="auto"></audio>
<audio id="count3_end" src="sounds/count3_end.mp3" preload="auto"></audio>
<audio id="count4_end" src="sounds/count4_end.mp3" preload="auto"></audio>
<audio id="count5_end" src="sounds/count5_end.mp3" preload="auto"></audio>
<audio id="count6_end" src="sounds/count6_end.mp3" preload="auto"></audio>
<audio id="count7_end" src="sounds/count7_end.mp3" preload="auto"></audio>
<audio id="count8_end" src="sounds/count8_end.mp3" preload="auto"></audio>
<audio id="count9_end" src="sounds/count9_end.mp3" preload="auto"></audio>
<audio id="count10_end" src="sounds/count10_end.mp3" preload="auto"></audio>

<div class="container">
  <h2>T√¨m c·∫∑p ƒë√¥i</h2>
  <div class="timer" id="timer"></div>
  <div class="message" id="message">Ch√∫c m·ª´ng b·∫°n nh√©!</div>

  <div class="grid" id="grid"></div>

  <div class="top-buttons">
    <button id="startBtn">‚ñ∂Ô∏è B·∫Øt ƒë·∫ßu</button>
    <button id="restartBtn">üîÑ Ch∆°i l·∫°i</button>
    <button id="endBtn">‚õî K·∫øt th√∫c</button>
    <button id="fullscreenBtn">üî≥ Full m√†n h√¨nh</button>
  </div>
</div>

<script>
/* ===================== */
/*        GAME JS        */
/* ===================== */

/* letters ƒë√£ ƒë·ªïi: b,d,ƒë */
const letters=["b","d","ƒë"];
let deck=[],first=null,second=null,lock=false,matched=0,countdown=null,canFlip=false;

const grid=document.getElementById("grid");
const timer=document.getElementById("timer");
const message=document.getElementById("message");

const startBtn=document.getElementById("startBtn");
const restartBtn=document.getElementById("restartBtn");
const endBtn=document.getElementById("endBtn");
const fullscreenBtn=document.getElementById("fullscreenBtn");

const correctSound=document.getElementById("correctSound");
const wrongSound=document.getElementById("wrongSound");
const winSound=document.getElementById("winSound");
const clapSound=document.getElementById("clapSound");
const startSound=document.getElementById("startSound");
const endSound=document.getElementById("endSound");

const countAudios = [
  document.getElementById("count5"),
  document.getElementById("count4"),
  document.getElementById("count3"),
  document.getElementById("count2"),
  document.getElementById("count1")
];

const countEndAudios = [
  document.getElementById("count10_end"), document.getElementById("count9_end"),
  document.getElementById("count8_end"), document.getElementById("count7_end"),
  document.getElementById("count6_end"), document.getElementById("count5_end"),
  document.getElementById("count4_end"), document.getElementById("count3_end"),
  document.getElementById("count2_end"), document.getElementById("count1_end")
];

function shuffle(a){return a.sort(()=>Math.random()-0.5);}

function createDeck(){
  deck=[];
  letters.forEach(l=>{
    deck.push({v:l,id:Math.random()});
    deck.push({v:l,id:Math.random()});
  });
  deck=shuffle(deck);
}

function draw(showAll=false){
  grid.innerHTML="";
  deck.forEach(c=>{
    const el=document.createElement("div");
    el.className="card";
    el.dataset.val=c.v;
    el.dataset.id=c.id;
    el.innerHTML=`
      <div class="card-inner">
        <div class="side front">?</div>
        <div class="side back">${c.v}</div>
      </div>`;
    if(showAll){
      el.classList.add("flipped");
    } else {
      el.onclick=()=>flip(el);
    }
    grid.appendChild(el);
  });
}

function flip(el){
  if(!canFlip || lock) return;
  if(el.classList.contains("matched") || el.classList.contains("flipped")) return;

  el.classList.add("flipped");

  if(!first){first=el;return;}

  second=el; lock=true;

  if(first.dataset.val===second.dataset.val){
    first.classList.add("matched");
    second.classList.add("matched");
    matched++;

    correctSound.currentTime=0; correctSound.play();

    reset();

    if(matched===letters.length){
      clearInterval(countdown);
      canFlip=false;

      timer.style.display="none";
      message.style.display="block";

      winSound.currentTime=0; winSound.play();
      clapSound.currentTime=0; clapSound.play();

      showFireworks();
    }
  } else {
    wrongSound.currentTime=0; wrongSound.play();
    setTimeout(()=>{
      first.classList.remove("flipped");
      second.classList.remove("flipped");
      reset();
    },800);
  }
}

function reset(){
  first=null; second=null; lock=false;
}

function startGame(){
  clearInterval(countdown);
  matched=0; canFlip=false;
  message.style.display="none";
  createDeck();
  draw();
  memorizePhase();
}

function memorizePhase(){
  document.querySelectorAll(".card").forEach(c=>c.classList.add("flipped"));
  timer.style.display="block";

  let t = 5;
  countdown = setInterval(()=>{
    if(t>0){
      timer.textContent = t;
      countAudios[5-t].currentTime=0;
      countAudios[5-t].play();
    }
    t--;

    if(t<0){
      clearInterval(countdown);
      document.querySelectorAll(".card").forEach(c=>c.classList.remove("flipped"));
      timer.style.display="none";
      canFlip = true;
      startSound.currentTime=0; startSound.play();
      playPhase();
    }
  },1000);
}

function playPhase(){
  clearInterval(countdown);
  let t=3000;

  countdown=setInterval(()=>{
    t--;

    if(t<=10 && t>0){
      timer.style.display="block";
      timer.textContent=t;
      countEndAudios[10-t].currentTime=0;
      countEndAudios[10-t].play();
    }

    if(t<=0){
      clearInterval(countdown);
      timer.style.display="none";
      document.querySelectorAll(".card").forEach(c=>c.classList.add("flipped"));
      canFlip=false;
      endSound.currentTime=0; endSound.play();
    }
  },1000);
}

function restartGame(){startGame();}

function endGame(){
  clearInterval(countdown);
  grid.innerHTML="";
  message.style.display="none";
  draw(true);
  canFlip=false;
  timer.style.display="none";
  first=null; second=null; lock=false; matched=0;
}

/* FULLSCREEN */
function toggleFullscreen() {
  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen();
    fullscreenBtn.textContent = "‚ùé Tho√°t fullscreen";
  } else {
    document.exitFullscreen();
    fullscreenBtn.textContent = "üî≥ Full m√†n h√¨nh";
  }
}

function showFireworks(){
  for(let i=0;i<30;i++){
    const fire=document.createElement("div");
    fire.className="firework";
    fire.style.left=Math.random()*window.innerWidth+"px";
    fire.style.top=Math.random()*window.innerHeight+"px";
    fire.style.background=`hsl(${Math.random()*360},100%,50%)`;
    document.body.appendChild(fire);
    setTimeout(()=>fire.remove(),800);
  }
}

startBtn.onclick=startGame;
restartBtn.onclick=restartGame;
endBtn.onclick=endGame;
fullscreenBtn.onclick=toggleFullscreen;

draw(true);
</script>

</body>
</html>

